# TX Watch - tmux configuration
# Optimized for Claude Code agent orchestration

# ============================================================================
# GENERAL SETTINGS
# ============================================================================

# Set prefix to Ctrl-a (easier than default Ctrl-b)
# set-option -g prefix C-a
# unbind-key C-b
# bind-key C-a send-prefix

# Improve colors
set-option -g default-terminal "screen-256color"
set-option -ga terminal-overrides ",xterm-256color:RGB"

# Enable mouse support
set-option -g mouse on

# Increase history
set-option -g history-limit 10000

# Reduce escape time delay
set-option -g escape-time 10

# Allow automatic window renaming
set-option -g automatic-rename on
set-option -g automatic-rename-format "#{pane_title}"

# ============================================================================
# WINDOW & PANE SETTINGS
# ============================================================================

# Start window and pane numbering from 1
set-option -g base-index 1
set-option -g pane-base-index 1

# Renumber windows when one is closed
set-option -g renumber-windows on

# Focus events
set-option -g focus-events on

# ============================================================================
# KEYBINDINGS
# ============================================================================

# Split panes with intuitive keys
bind-key "|" split-window -h
bind-key "-" split-window -v

# Navigate between panes with arrow keys
bind-key -n M-Up select-pane -U
bind-key -n M-Down select-pane -D
bind-key -n M-Left select-pane -L
bind-key -n M-Right select-pane -R

# Resize panes with Shift+arrow
bind-key -n S-Up resize-pane -U 5
bind-key -n S-Down resize-pane -D 5
bind-key -n S-Left resize-pane -L 5
bind-key -n S-Right resize-pane -R 5

# Swap panes
bind-key -n M-n swap-pane -U
bind-key -n M-m swap-pane -D

# Switch windows with Ctrl+arrow
bind-key -n C-Left previous-window
bind-key -n C-Right next-window

# Quick window switching with Alt+number
bind-key -n M-0 select-window -t 0
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9

# Reload config with Ctrl-a r
bind-key r source-file ~/.tmux.conf \; display "Config reloaded"

# Kill pane/window/session
bind-key x kill-pane
bind-key X kill-window
bind-key C-x kill-session

# New window
bind-key n new-window -c "#{pane_current_path}"
bind-key N new-session

# Detach
bind-key d detach-client

# Copy mode
bind-key [ copy-mode
bind-key ] paste-buffer

# ============================================================================
# STATUS BAR
# ============================================================================

set-option -g status on
set-option -g status-position bottom
set-option -g status-interval 15
set-option -g status-justify left

# Status bar styling
set-option -g status-style "bg=#1e1e1e,fg=#d4d4d4"

# Status bar format
set-option -g status-left "#[bg=#007acc,fg=#ffffff,bold] TX Watch #[default] #S "
set-option -g status-right " #[bold]%H:%M#[default] %a %d-%b "

# Window status
set-option -g window-status-format "#[bg=#2d2d2d,fg=#d4d4d4] #I:#W "
set-option -g window-status-current-format "#[bg=#007acc,fg=#ffffff,bold] #I:#W #[default]"

# Message style
set-option -g message-style "bg=#007acc,fg=#ffffff"
set-option -g message-command-style "bg=#1e1e1e,fg=#d4d4d4"

# ============================================================================
# PANE BORDERS
# ============================================================================

set-option -g pane-border-style "fg=#404040"
set-option -g pane-active-border-style "fg=#007acc"

# ============================================================================
# TX WATCH SPECIFIC SETTINGS
# ============================================================================

# For Claude Code sessions - increase timeout
set-option -g lock-after-time 0
set-option -g lock-command "clear"

# Allow terminal to set window title
set-option -g allow-rename on

# Enable bell for notifications
set-option -g bell-action any
set-option -g visual-bell off

# ============================================================================
# PLUGIN SUPPORT (Optional)
# ============================================================================

# Uncomment to use tpm (Tmux Plugin Manager)
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-yank'
# set -g @plugin 'tmux-plugins/tmux-open'
#
# run '~/.tmux/plugins/tpm/tpm'

# ============================================================================
# NOTES FOR TX WATCH USAGE
# ============================================================================

# Quick Reference:
# - Ctrl-a + | : Split pane horizontally
# - Ctrl-a + - : Split pane vertically
# - Alt + arrows : Navigate between panes
# - Ctrl + arrows : Switch between windows
# - Alt + 0-9 : Jump to window by number
# - Ctrl-a + x : Kill current pane
# - Ctrl-a + X : Kill current window
# - Ctrl-a + d : Detach from session
# - Ctrl-a + r : Reload tmux config
#
# TX Watch Integration:
# - tx start       : Creates 'core' tmux session
# - tx spawn mesh  : Creates 'mesh-agent' tmux session
# - tx attach      : Attaches to active session
# - tx kill mesh   : Kills tmux session
