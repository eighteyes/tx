# Task UID Feature

## Overview

When spawning a mesh with an initial task (`tx spawn` with `-i` flag), the session and folder names now automatically include a 4-character alphanumeric UID suffix derived from the task description.

## How It Works

### UID Generation

The UID is generated by:
1. **Extracting words** from the task description (split on spaces, hyphens, underscores)
2. **Taking the first letter** of each word (lowercase)
3. **Padding to 4 characters** with incrementing digits if less than 4 letters
4. **Truncating to 4 characters** if more than 4 letters

### Examples

| Task | UID | Generated | Reason |
|------|-----|-----------|--------|
| `analyze codebase` | `ac01` | a + c + padding (01) | 2 letters + 2 digits |
| `test echo agent` | `tea0` | t + e + a + padding (0) | 3 letters + 1 digit |
| `deploy service to production` | `dstp` | d + s + t + p | Exactly 4 letters |
| `fix bug` | `fb01` | f + b + padding (01) | 2 letters + 2 digits |
| `hello world foo bar baz qux` | `hwfb` | h + w + f + b | Truncated to first 4 |

## Usage

### Command Syntax

```bash
tx spawn <mesh> [agent] -i "<task description>"
```

### Example

```bash
tx spawn core core -i "analyze codebase"
```

This creates:
- **Session name**: `core-core-ac01` (or just `core-ac01` if mesh equals agent)
- **Folder structure**: `.ai/tx/mesh/core/agents/core-ac01/`
- **Agent directory**: Includes `msgs/`, `prompts/`, and other subdirectories

### Output

```
ðŸš€ Spawning core/core (UID: ac01)...

ðŸ“‚ Initializing communication directories...
âœ… Directories created

...

âœ… core/core (ac01) spawned!

   Session: core-ac01
   Attach: tmux attach -t core-ac01
   Stop: tx stop core core
```

## Technical Implementation

### Files Modified

- `lib/commands/spawn.js`
  - Added `generateTaskUID(task)` function (lines 9-42)
  - Integrated UID generation into spawn flow (lines 48-56)
  - Updated all directory and session naming to use `finalAgentName` (includes UID)
  - Enhanced logging to show UID information

### Changes to Spawn Flow

1. **Task Option Check** (line 51)
   - If `options.init` is provided, extract the UID

2. **UID Suffix Application** (line 54)
   - Append UID to agent name: `${agentName}-${taskUID}`
   - This becomes `finalAgentName`

3. **Consistent Naming** (lines 73-74, 133, 144, 156)
   - All directory paths use `finalAgentName`
   - Session name uses `finalAgentName`
   - Prompt builder receives `finalAgentName`

4. **Logging & State** (lines 159-170)
   - Original agent name shown in output for clarity
   - UID displayed alongside agent name
   - State stored with `finalAgentName` for tracking

## Benefits

âœ… **Unique Identification**: Each spawned mesh instance has a unique suffix based on its task
âœ… **Task Context**: The UID makes it immediately clear what task a session is for
âœ… **Deterministic**: Same task always generates the same UID
âœ… **Compact**: Only 4 characters - easy to type and remember
âœ… **No Breaking Changes**: Without `-i` flag, behavior is unchanged

## Backward Compatibility

- **Without `-i` flag**: Spawn behaves exactly as before (no UID suffix)
- **Existing sessions**: Not affected by this change
- **Folder structure**: Remains the same when no task is provided

## Notes

- The UID is only generated when a task is provided via `-i` flag
- The original agent name is preserved in logging for clarity
- The UID becomes part of the file system paths and session names for consistency
